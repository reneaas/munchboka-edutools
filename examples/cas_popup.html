
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>CAS Popup Examples &#8212; munchboka-edutools</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/munchboka/css/flashcards.css?v=9542c1b9" />
    <link rel="stylesheet" type="text/css" href="../_static/munchboka/css/general_style.css?v=57d653fb" />
    <link rel="stylesheet" type="text/css" href="../_static/munchboka/css/interactive_code.css?v=f903e660" />
    <link rel="stylesheet" type="text/css" href="../_static/munchboka/css/jeopardy.css?v=e40b38cf" />
    <link rel="stylesheet" type="text/css" href="../_static/munchboka/css/quiz.css?v=3f648898" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css" />
    <link rel="stylesheet" type="text/css" href="https://code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/munchboka/css/admonitions.css?v=5c924dd9" />
    <link rel="stylesheet" type="text/css" href="../_static/munchboka/css/dialogue.css?v=1b585024" />
    <link rel="stylesheet" type="text/css" href="../_static/munchboka/css/figures.css?v=5dd46ff0" />
    <link rel="stylesheet" type="text/css" href="../_static/munchboka/css/popup.css?v=26181dfd" />
    <link rel="stylesheet" type="text/css" href="../_static/munchboka/css/timedQuiz.css?v=89e27729" />
    <link rel="stylesheet" type="text/css" href="../_static/munchboka/css/cas_popup.css?v=bae4ad7e" />
    <link rel="stylesheet" type="text/css" href="../_static/munchboka/css/github-light.css?v=a6d10b1c" />
    <link rel="stylesheet" type="text/css" href="../_static/munchboka/css/github-dark.css?v=2454bc3f" />
    <link rel="stylesheet" type="text/css" href="../_static/munchboka/css/github-dark-high-contrast.css?v=4c0c1b0f" />
    <link rel="stylesheet" type="text/css" href="../_static/munchboka/css/pairPuzzle/style.css?v=f77426ac" />
    <link rel="stylesheet" type="text/css" href="../_static/munchboka/css/escapeRoom/escape-room.css?v=241d39f0" />
    <link rel="stylesheet" type="text/css" href="../_static/munchboka/css/parsons/parsonsPuzzle.css?v=9fbab2c7" />
    <link id="highlight-theme-light" rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/github.min.css" />
    <link id="highlight-theme-dark" rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/github-dark.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/munchboka/js/utils.js?v=a5b18a1c"></script>
    <script src="../_static/munchboka/js/casThemeManager.js?v=88874cc7"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.js"></script>
    <script src="../_static/munchboka/js/skulpt/skulpt.js?v=51c28977"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/auto-render.min.js"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script src="../_static/munchboka/js/flashcards.js?v=28a4399e"></script>
    <script src="../_static/munchboka/js/interactiveCode/interactiveCodeSetup.js?v=733f5585"></script>
    <script src="../_static/munchboka/js/interactiveCode/codeEditor.js?v=30f3f389"></script>
    <script src="../_static/munchboka/js/interactiveCode/pythonRunner.js?v=e9f0c2d2"></script>
    <script src="../_static/munchboka/js/interactiveCode/workerManager.js?v=b934d01d"></script>
    <script src="../_static/munchboka/js/interactiveCode/turtleCode.js?v=0d62d95e"></script>
    <script src="../_static/munchboka/js/jeopardy.js?v=e090935c"></script>
    <script src="../_static/munchboka/js/quiz.js?v=a4e1ffeb"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/munchboka/js/popup.js?v=5db611f4"></script>
    <script src="../_static/munchboka/js/timedQuiz/utils.js?v=2c6f871c"></script>
    <script src="../_static/munchboka/js/timedQuiz/multipleChoiceQuestion.js?v=c6ce1ca2"></script>
    <script src="../_static/munchboka/js/timedQuiz/timedMultipleChoiceQuiz.js?v=9accc73d"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'examples/cas_popup';</script>
    <script src="../_static/munchboka/js/pairPuzzle/draggableItem.js?v=ce9ef7bd"></script>
    <script src="../_static/munchboka/js/pairPuzzle/dropZone.js?v=56907477"></script>
    <script src="../_static/munchboka/js/pairPuzzle/game.js?v=cb8b0d45"></script>
    <script src="../_static/munchboka/js/escapeRoom/escape-room.js?v=e52321b4"></script>
    <script src="../_static/munchboka/js/parsons/parsonsPuzzle.js?v=6e8c8774"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js"></script>
    <script src="../_static/munchboka/js/highlight-init.js?v=6bc17905"></script>
    <script src="https://www.geogebra.org/apps/deployggb.js"></script>
    <script src="../_static/munchboka/js/geogebra-setup.js?v=8e77fc11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/python/python.min.js"></script>
    <link rel="canonical" href="https://dev.munchboka.no/examples/cas_popup.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Factor Tree Examples" href="factor_tree.html" />
    <link rel="prev" title="Interactive Code Examples" href="interactive_code.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">munchboka-edutools</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="plot.html"><code class="docutils literal notranslate"><span class="pre">plot</span></code> directive</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_plot.html"><code class="docutils literal notranslate"><span class="pre">multiplot</span></code> directive</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_plot_point.html">Multi-Plot Point Keyword Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_plot_text.html">multi-plot text examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_plot_annotate.html">multi-plot annotate examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi_plot2_test.html">Multi-Plot2 Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="signchart.html"><code class="docutils literal notranslate"><span class="pre">signchart</span></code> directive</a></li>
<li class="toctree-l1"><a class="reference internal" href="polydiv.html">Polydiv Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="horner.html">Horner Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="quiz/quiz.html"><code class="docutils literal notranslate"><span class="pre">quiz</span></code> directive</a></li>
<li class="toctree-l1"><a class="reference internal" href="jeopardy/jeopardy.html">Jeopardy example</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactive_code.html">Interactive Code Examples</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">CAS Popup Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="factor_tree.html">Factor Tree Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="pair_puzzle.html">Pair Puzzle Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="escape_room.html">Escape Room Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="escape_room/escape_room.html">Example: Escape Room</a></li>
<li class="toctree-l1"><a class="reference internal" href="escape_room2.html">Escape Room 2 Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="admonitions.html">Custom Admonitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="dialogue.html">Dialogue Directive Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="clear.html">Clear Directive Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="parsons.html">Parsons Puzzle Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="popup.html">Popup Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="ggb_icon.html">GeoGebra Icon Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="ggb_popup.html">GeoGebra Popup Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="ggb.html">GeoGebra Applet Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="poly_icon.html">Polynomial Icon Role</a></li>
<li class="toctree-l1"><a class="reference internal" href="timed_quiz.html">Timed Quiz Directive</a></li>
<li class="toctree-l1"><a class="reference internal" href="turtle.html">Turtle Graphics Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="flashcards.html">Flashcards-eksempel</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/examples/cas_popup.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>CAS Popup Examples</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-usage">Basic Usage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-size">Custom Size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-button-text-and-title">Custom Button Text and Title</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#norwegian-text">Norwegian Text</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sidebar-layout">Sidebar Layout</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-cas-windows">Multiple CAS Windows</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#features">Features</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#technical-details">Technical Details</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="cas-popup-examples">
<h1>CAS Popup Examples<a class="headerlink" href="#cas-popup-examples" title="Link to this heading">#</a></h1>
<p>This page demonstrates the <code class="docutils literal notranslate"><span class="pre">cas-popup</span></code> directive, which creates a button that opens a GeoGebra CAS (Computer Algebra System) window in a popup dialog.</p>
<section id="basic-usage">
<h2>Basic Usage<a class="headerlink" href="#basic-usage" title="Link to this heading">#</a></h2>
<p>Default 350x500 CAS window:</p>


<meta name="viewport" content="width=device-width, initial-scale=1">

<button id="button-ggb-cas-2bf3c6a5" class="ggb-cas-button">Åpne CAS‑vindu</button>
<div id="dialog-ggb-cas-2bf3c6a5" title="CAS‑vindu" style="display:none;">
    <div id="ggb-cas-2bf3c6a5" class="ggb-window"></div>
</div>

<style>
.ui-resizable-handle { min-width:16px;min-height:16px; }
.ui-dialog-content{padding:0!important;}
.ggb-window       {width:100%!important;height:100%!important;box-sizing:border-box;}
.ggb-cas-button   {margin-top: 1em; margin-bottom: 1em;}
.ggb-reset-btn {
  position: absolute;
  right: 2.5em;
  top: 50%;
  transform: translateY(-50%);
  width: 2em;
  height: 2em;
  padding: 0.25em;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  border-radius: 4px;
  background: transparent;
  cursor: pointer;
  transition: background-color 0.2s, opacity 0.2s;
  opacity: 0.7;
}
.ggb-reset-btn:hover {
  opacity: 1;
  background-color: rgba(0, 0, 0, 0.1);
}
[data-theme="dark"] .ggb-reset-btn:hover,
html[data-theme="dark"] .ggb-reset-btn:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.ggb-reset-btn svg {
  color: inherit;
}
</style>

<script>
(function() {
  $(function() {
    let ggbReady = false;
    const storageKey = 'ggb-cas-state-ggb-cas-2bf3c6a5';

    function applySize() {
      if (!ggbReady) return;
      const w = $("#ggb-cas-2bf3c6a5").width(),
            h = $("#ggb-cas-2bf3c6a5").height();
      window.ggbApplet.setSize(Math.round(w), Math.round(h));
    }

    function saveState() {
      if (!ggbReady || !window.ggbApplet) return;
      try {
        const state = window.ggbApplet.getBase64();
        localStorage.setItem(storageKey, state);
        // Update timestamp for this state
        localStorage.setItem(storageKey + '-timestamp', Date.now().toString());
      } catch (e) {
        // If quota exceeded, try cleaning up old states and retry
        if (e.name === 'QuotaExceededError') {
          cleanupOldStates();
          try {
            const state = window.ggbApplet.getBase64();
            localStorage.setItem(storageKey, state);
            localStorage.setItem(storageKey + '-timestamp', Date.now().toString());
          } catch (retryError) {
            // Still failed after cleanup - silently give up
          }
        }
      }
    }

    function cleanupOldStates() {
      try {
        // Find all GeoGebra CAS states with timestamps
        const casStates = [];
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          if (key && key.startsWith('ggb-cas-state-') && key.endsWith('-timestamp')) {
            const stateKey = key.replace('-timestamp', '');
            const timestamp = parseInt(localStorage.getItem(key) || '0', 10);
            casStates.push({ key: stateKey, timestamp: timestamp });
          }
        }
        
        // Sort by timestamp (oldest first)
        casStates.sort((a, b) => a.timestamp - b.timestamp);
        
        // Delete oldest 25% of states (minimum 1, maximum 10)
        const numToDelete = Math.max(1, Math.min(10, Math.floor(casStates.length * 0.25)));
        for (let i = 0; i < numToDelete && i < casStates.length; i++) {
          localStorage.removeItem(casStates[i].key);
          localStorage.removeItem(casStates[i].key + '-timestamp');
        }
      } catch (e) {
        // Cleanup failed - silently continue
      }
    }

    function restoreState() {
      if (!ggbReady || !window.ggbApplet) return;
      try {
        const savedState = localStorage.getItem(storageKey);
        if (savedState) {
          window.ggbApplet.setBase64(savedState);
          // Re-apply custom toolbar after restoring state to prevent it from being overwritten
          setTimeout(() => {
            if (window.ggbApplet && window.ggbApplet.setCustomToolBar) {
              window.ggbApplet.setCustomToolBar("1001 | 1002 | 1007 | 1010 | 6");
            }
          }, 50);
        }
      } catch (e) {
        // Silently fail if restore fails
      }
    }

    const $dlg = $("#dialog-ggb-cas-2bf3c6a5").dialog({
      autoOpen: false,
      width: 390, height: 580,
      resizable: true, draggable: true,
      position: { my: "center", at: "center", of: window },
      resize: () => window.requestAnimationFrame(applySize),
      open: function() {
        if (!ggbReady) {
          new GGBApplet({
            appName: "classic", id: "ggb-cas-2bf3c6a5",
            width: 350, height: 500,
            perspective: "C", language: "nb",
            showToolBar: true, showAlgebraInput: false,
            borderRadius: 8, enableRightClick: true, showKeyboardOnFocus: false,
            customToolBar: "1001 | 1002 | 1007 | 1010 | 6",
            appletOnLoad: () => { 
              ggbReady = true; 
              applySize();
              // Restore state after a short delay to ensure GeoGebra is fully initialized
              setTimeout(restoreState, 100);
            }
          }, true).inject("ggb-cas-2bf3c6a5");
        } else {
          applySize();
        }
      },
      close: function() {
        // Save state when dialog is closed
        saveState();
      }
    });

    // Add refresh button to title bar
    const titleBar = $dlg.parent().find('.ui-dialog-titlebar');
    const refreshBtn = $('<button type="button" class="ggb-reset-btn" title="Start på nytt (slett lagret innhold)"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.65 2.35C12.2 0.9 10.21 0 8 0 3.58 0 0.01 3.58 0.01 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L9 7h7V0l-2.35 2.35z" fill="currentColor"/></svg></button>');
    refreshBtn.on('click', function() {
      if (confirm('Er du sikker på at du vil slette lagret innhold og starte på nytt?')) {
        try {
          localStorage.removeItem(storageKey);
          localStorage.removeItem(storageKey + '-timestamp');
          if (ggbReady && window.ggbApplet) {
            // Clear the container
            $("#ggb-cas-2bf3c6a5").empty();
            // Reset the flag
            ggbReady = false;
            // Recreate the applet from scratch
            new GGBApplet({
              appName: "classic", id: "ggb-cas-2bf3c6a5",
              width: 350, height: 500,
              perspective: "C", language: "nb",
              showToolBar: true, showAlgebraInput: false,
              borderRadius: 8, enableRightClick: true, showKeyboardOnFocus: false,
              customToolBar: "1001 | 1002 | 1007 | 1010 | 6",
              appletOnLoad: () => { 
                ggbReady = true; 
                applySize();
              }
            }, true).inject("ggb-cas-2bf3c6a5");
          }
        } catch (e) {
          console.error('Failed to reset:', e);
        }
      }
    });
    titleBar.append(refreshBtn);

    // Save state when page is unloaded (refresh, navigate away, close tab)
    $(window).on('beforeunload', function() {
      if ($dlg.dialog('isOpen')) {
        saveState();
      }
    });

    // Prevent background scroll when GeoGebra applet is active
    let scrollLocked = false;
    let lockedScrollTop = 0;
    let keyHandler = null;
    let wheelHandler = null;
    let scrollHandler = null;
    
    function lockScroll() {
      if (scrollLocked) return;
      scrollLocked = true;
      lockedScrollTop = window.pageYOffset || document.documentElement.scrollTop || 0;
      
      // Instead of preventing keys, monitor and restore scroll position
      scrollHandler = () => {
        if (scrollLocked) {
          const currentScroll = window.pageYOffset || document.documentElement.scrollTop || 0;
          if (currentScroll !== lockedScrollTop) {
            window.scrollTo(0, lockedScrollTop);
          }
        }
      };
      
      // Prevent wheel scrolling on the page background
      wheelHandler = (e) => {
        const dialogElement = e.target.closest('.ui-dialog');
        if (dialogElement) {
          // Allow scrolling within dialog elements that can scroll
          let target = e.target;
          while (target && target !== dialogElement) {
            const overflow = window.getComputedStyle(target).overflow;
            if (overflow === 'auto' || overflow === 'scroll') {
              return; // Allow internal scrolling
            }
            target = target.parentElement;
          }
          // Prevent page scroll but don't stop the event from reaching GeoGebra
          if (!e.target.closest('#ggb-cas-2bf3c6a5')) {
            e.preventDefault();
            e.stopPropagation();
          }
        }
      };
      
      // Monitor scroll events to maintain position
      window.addEventListener('scroll', scrollHandler, { passive: true });
      document.addEventListener('wheel', wheelHandler, { capture: true, passive: false });
    }
    
    function unlockScroll() {
      if (!scrollLocked) return;
      scrollLocked = false;
      
      if (scrollHandler) {
        window.removeEventListener('scroll', scrollHandler);
        scrollHandler = null;
      }
      if (wheelHandler) {
        document.removeEventListener('wheel', wheelHandler, { capture: true });
        wheelHandler = null;
      }
    }
    
    // Monitor GeoGebra applet focus/interaction to control scroll lock
    function bindScrollLock() {
      const ggbContainer = document.getElementById('ggb-cas-2bf3c6a5');
      if (!ggbContainer) {
        setTimeout(bindScrollLock, 300);
        return;
      }
      
      // Look for the actual GeoGebra canvas/applet elements
      const ggbApplet = ggbContainer.querySelector('canvas') || 
                       ggbContainer.querySelector('.ggbApplet') ||
                       ggbContainer.querySelector('[id^="ggbApplet"]') ||
                       ggbContainer;
      
      if (ggbApplet) {
        // Lock scroll when interacting with GeoGebra
        ggbApplet.addEventListener('mousedown', lockScroll);
        ggbApplet.addEventListener('focus', lockScroll);
        ggbApplet.addEventListener('click', lockScroll);
        
        // Also monitor the container for any focus events
        ggbContainer.addEventListener('focusin', lockScroll);
        ggbContainer.addEventListener('mousedown', lockScroll);
        
        // Unlock when clicking outside or losing focus
        document.addEventListener('click', (e) => {
          if (!ggbContainer.contains(e.target) && !e.target.closest('.ui-dialog')) {
            unlockScroll();
          }
        });
        
        ggbContainer.addEventListener('focusout', (e) => {
          // Small delay to check if focus moved outside the container
          setTimeout(() => {
            if (!ggbContainer.contains(document.activeElement)) {
              unlockScroll();
            }
          }, 100);
        });
      }
    }
    
    // Start monitoring after GeoGebra is loaded
    setTimeout(bindScrollLock, 1000);
    
    // Cleanup on dialog close
    $dlg.on('dialogclose', unlockScroll);

    $("#button-ggb-cas-2bf3c6a5").button()
      .on("click touchend pointerup", e => {
        e.preventDefault();
        $("#dialog-ggb-cas-2bf3c6a5").dialog("open");
      });
  });
})();
</script>

        </section>
<section id="custom-size">
<h2>Custom Size<a class="headerlink" href="#custom-size" title="Link to this heading">#</a></h2>
<p>A larger 600x700 window:</p>


<meta name="viewport" content="width=device-width, initial-scale=1">

<button id="button-ggb-cas-a78fc2bc" class="ggb-cas-button">Åpne CAS‑vindu</button>
<div id="dialog-ggb-cas-a78fc2bc" title="CAS‑vindu" style="display:none;">
    <div id="ggb-cas-a78fc2bc" class="ggb-window"></div>
</div>

<style>
.ui-resizable-handle { min-width:16px;min-height:16px; }
.ui-dialog-content{padding:0!important;}
.ggb-window       {width:100%!important;height:100%!important;box-sizing:border-box;}
.ggb-cas-button   {margin-top: 1em; margin-bottom: 1em;}
.ggb-reset-btn {
  position: absolute;
  right: 2.5em;
  top: 50%;
  transform: translateY(-50%);
  width: 2em;
  height: 2em;
  padding: 0.25em;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  border-radius: 4px;
  background: transparent;
  cursor: pointer;
  transition: background-color 0.2s, opacity 0.2s;
  opacity: 0.7;
}
.ggb-reset-btn:hover {
  opacity: 1;
  background-color: rgba(0, 0, 0, 0.1);
}
[data-theme="dark"] .ggb-reset-btn:hover,
html[data-theme="dark"] .ggb-reset-btn:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.ggb-reset-btn svg {
  color: inherit;
}
</style>

<script>
(function() {
  $(function() {
    let ggbReady = false;
    const storageKey = 'ggb-cas-state-ggb-cas-a78fc2bc';

    function applySize() {
      if (!ggbReady) return;
      const w = $("#ggb-cas-a78fc2bc").width(),
            h = $("#ggb-cas-a78fc2bc").height();
      window.ggbApplet.setSize(Math.round(w), Math.round(h));
    }

    function saveState() {
      if (!ggbReady || !window.ggbApplet) return;
      try {
        const state = window.ggbApplet.getBase64();
        localStorage.setItem(storageKey, state);
        // Update timestamp for this state
        localStorage.setItem(storageKey + '-timestamp', Date.now().toString());
      } catch (e) {
        // If quota exceeded, try cleaning up old states and retry
        if (e.name === 'QuotaExceededError') {
          cleanupOldStates();
          try {
            const state = window.ggbApplet.getBase64();
            localStorage.setItem(storageKey, state);
            localStorage.setItem(storageKey + '-timestamp', Date.now().toString());
          } catch (retryError) {
            // Still failed after cleanup - silently give up
          }
        }
      }
    }

    function cleanupOldStates() {
      try {
        // Find all GeoGebra CAS states with timestamps
        const casStates = [];
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          if (key && key.startsWith('ggb-cas-state-') && key.endsWith('-timestamp')) {
            const stateKey = key.replace('-timestamp', '');
            const timestamp = parseInt(localStorage.getItem(key) || '0', 10);
            casStates.push({ key: stateKey, timestamp: timestamp });
          }
        }
        
        // Sort by timestamp (oldest first)
        casStates.sort((a, b) => a.timestamp - b.timestamp);
        
        // Delete oldest 25% of states (minimum 1, maximum 10)
        const numToDelete = Math.max(1, Math.min(10, Math.floor(casStates.length * 0.25)));
        for (let i = 0; i < numToDelete && i < casStates.length; i++) {
          localStorage.removeItem(casStates[i].key);
          localStorage.removeItem(casStates[i].key + '-timestamp');
        }
      } catch (e) {
        // Cleanup failed - silently continue
      }
    }

    function restoreState() {
      if (!ggbReady || !window.ggbApplet) return;
      try {
        const savedState = localStorage.getItem(storageKey);
        if (savedState) {
          window.ggbApplet.setBase64(savedState);
          // Re-apply custom toolbar after restoring state to prevent it from being overwritten
          setTimeout(() => {
            if (window.ggbApplet && window.ggbApplet.setCustomToolBar) {
              window.ggbApplet.setCustomToolBar("1001 | 1002 | 1007 | 1010 | 6");
            }
          }, 50);
        }
      } catch (e) {
        // Silently fail if restore fails
      }
    }

    const $dlg = $("#dialog-ggb-cas-a78fc2bc").dialog({
      autoOpen: false,
      width: 640, height: 780,
      resizable: true, draggable: true,
      position: { my: "center", at: "center", of: window },
      resize: () => window.requestAnimationFrame(applySize),
      open: function() {
        if (!ggbReady) {
          new GGBApplet({
            appName: "classic", id: "ggb-cas-a78fc2bc",
            width: 600, height: 700,
            perspective: "C", language: "nb",
            showToolBar: true, showAlgebraInput: false,
            borderRadius: 8, enableRightClick: true, showKeyboardOnFocus: false,
            customToolBar: "1001 | 1002 | 1007 | 1010 | 6",
            appletOnLoad: () => { 
              ggbReady = true; 
              applySize();
              // Restore state after a short delay to ensure GeoGebra is fully initialized
              setTimeout(restoreState, 100);
            }
          }, true).inject("ggb-cas-a78fc2bc");
        } else {
          applySize();
        }
      },
      close: function() {
        // Save state when dialog is closed
        saveState();
      }
    });

    // Add refresh button to title bar
    const titleBar = $dlg.parent().find('.ui-dialog-titlebar');
    const refreshBtn = $('<button type="button" class="ggb-reset-btn" title="Start på nytt (slett lagret innhold)"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.65 2.35C12.2 0.9 10.21 0 8 0 3.58 0 0.01 3.58 0.01 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L9 7h7V0l-2.35 2.35z" fill="currentColor"/></svg></button>');
    refreshBtn.on('click', function() {
      if (confirm('Er du sikker på at du vil slette lagret innhold og starte på nytt?')) {
        try {
          localStorage.removeItem(storageKey);
          localStorage.removeItem(storageKey + '-timestamp');
          if (ggbReady && window.ggbApplet) {
            // Clear the container
            $("#ggb-cas-a78fc2bc").empty();
            // Reset the flag
            ggbReady = false;
            // Recreate the applet from scratch
            new GGBApplet({
              appName: "classic", id: "ggb-cas-a78fc2bc",
              width: 600, height: 700,
              perspective: "C", language: "nb",
              showToolBar: true, showAlgebraInput: false,
              borderRadius: 8, enableRightClick: true, showKeyboardOnFocus: false,
              customToolBar: "1001 | 1002 | 1007 | 1010 | 6",
              appletOnLoad: () => { 
                ggbReady = true; 
                applySize();
              }
            }, true).inject("ggb-cas-a78fc2bc");
          }
        } catch (e) {
          console.error('Failed to reset:', e);
        }
      }
    });
    titleBar.append(refreshBtn);

    // Save state when page is unloaded (refresh, navigate away, close tab)
    $(window).on('beforeunload', function() {
      if ($dlg.dialog('isOpen')) {
        saveState();
      }
    });

    // Prevent background scroll when GeoGebra applet is active
    let scrollLocked = false;
    let lockedScrollTop = 0;
    let keyHandler = null;
    let wheelHandler = null;
    let scrollHandler = null;
    
    function lockScroll() {
      if (scrollLocked) return;
      scrollLocked = true;
      lockedScrollTop = window.pageYOffset || document.documentElement.scrollTop || 0;
      
      // Instead of preventing keys, monitor and restore scroll position
      scrollHandler = () => {
        if (scrollLocked) {
          const currentScroll = window.pageYOffset || document.documentElement.scrollTop || 0;
          if (currentScroll !== lockedScrollTop) {
            window.scrollTo(0, lockedScrollTop);
          }
        }
      };
      
      // Prevent wheel scrolling on the page background
      wheelHandler = (e) => {
        const dialogElement = e.target.closest('.ui-dialog');
        if (dialogElement) {
          // Allow scrolling within dialog elements that can scroll
          let target = e.target;
          while (target && target !== dialogElement) {
            const overflow = window.getComputedStyle(target).overflow;
            if (overflow === 'auto' || overflow === 'scroll') {
              return; // Allow internal scrolling
            }
            target = target.parentElement;
          }
          // Prevent page scroll but don't stop the event from reaching GeoGebra
          if (!e.target.closest('#ggb-cas-a78fc2bc')) {
            e.preventDefault();
            e.stopPropagation();
          }
        }
      };
      
      // Monitor scroll events to maintain position
      window.addEventListener('scroll', scrollHandler, { passive: true });
      document.addEventListener('wheel', wheelHandler, { capture: true, passive: false });
    }
    
    function unlockScroll() {
      if (!scrollLocked) return;
      scrollLocked = false;
      
      if (scrollHandler) {
        window.removeEventListener('scroll', scrollHandler);
        scrollHandler = null;
      }
      if (wheelHandler) {
        document.removeEventListener('wheel', wheelHandler, { capture: true });
        wheelHandler = null;
      }
    }
    
    // Monitor GeoGebra applet focus/interaction to control scroll lock
    function bindScrollLock() {
      const ggbContainer = document.getElementById('ggb-cas-a78fc2bc');
      if (!ggbContainer) {
        setTimeout(bindScrollLock, 300);
        return;
      }
      
      // Look for the actual GeoGebra canvas/applet elements
      const ggbApplet = ggbContainer.querySelector('canvas') || 
                       ggbContainer.querySelector('.ggbApplet') ||
                       ggbContainer.querySelector('[id^="ggbApplet"]') ||
                       ggbContainer;
      
      if (ggbApplet) {
        // Lock scroll when interacting with GeoGebra
        ggbApplet.addEventListener('mousedown', lockScroll);
        ggbApplet.addEventListener('focus', lockScroll);
        ggbApplet.addEventListener('click', lockScroll);
        
        // Also monitor the container for any focus events
        ggbContainer.addEventListener('focusin', lockScroll);
        ggbContainer.addEventListener('mousedown', lockScroll);
        
        // Unlock when clicking outside or losing focus
        document.addEventListener('click', (e) => {
          if (!ggbContainer.contains(e.target) && !e.target.closest('.ui-dialog')) {
            unlockScroll();
          }
        });
        
        ggbContainer.addEventListener('focusout', (e) => {
          // Small delay to check if focus moved outside the container
          setTimeout(() => {
            if (!ggbContainer.contains(document.activeElement)) {
              unlockScroll();
            }
          }, 100);
        });
      }
    }
    
    // Start monitoring after GeoGebra is loaded
    setTimeout(bindScrollLock, 1000);
    
    // Cleanup on dialog close
    $dlg.on('dialogclose', unlockScroll);

    $("#button-ggb-cas-a78fc2bc").button()
      .on("click touchend pointerup", e => {
        e.preventDefault();
        $("#dialog-ggb-cas-a78fc2bc").dialog("open");
      });
  });
})();
</script>

        </section>
<section id="custom-button-text-and-title">
<h2>Custom Button Text and Title<a class="headerlink" href="#custom-button-text-and-title" title="Link to this heading">#</a></h2>
<p>Custom button text and dialog title:</p>


<meta name="viewport" content="width=device-width, initial-scale=1">

<button id="button-ggb-cas-250aaa33" class="ggb-cas-button">"Open</button>
<div id="dialog-ggb-cas-250aaa33" title="Calculator" "My CAS Window"" style="display:none;">
    <div id="ggb-cas-250aaa33" class="ggb-window"></div>
</div>

<style>
.ui-resizable-handle { min-width:16px;min-height:16px; }
.ui-dialog-content{padding:0!important;}
.ggb-window       {width:100%!important;height:100%!important;box-sizing:border-box;}
.ggb-cas-button   {margin-top: 1em; margin-bottom: 1em;}
.ggb-reset-btn {
  position: absolute;
  right: 2.5em;
  top: 50%;
  transform: translateY(-50%);
  width: 2em;
  height: 2em;
  padding: 0.25em;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  border-radius: 4px;
  background: transparent;
  cursor: pointer;
  transition: background-color 0.2s, opacity 0.2s;
  opacity: 0.7;
}
.ggb-reset-btn:hover {
  opacity: 1;
  background-color: rgba(0, 0, 0, 0.1);
}
[data-theme="dark"] .ggb-reset-btn:hover,
html[data-theme="dark"] .ggb-reset-btn:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.ggb-reset-btn svg {
  color: inherit;
}
</style>

<script>
(function() {
  $(function() {
    let ggbReady = false;
    const storageKey = 'ggb-cas-state-ggb-cas-250aaa33';

    function applySize() {
      if (!ggbReady) return;
      const w = $("#ggb-cas-250aaa33").width(),
            h = $("#ggb-cas-250aaa33").height();
      window.ggbApplet.setSize(Math.round(w), Math.round(h));
    }

    function saveState() {
      if (!ggbReady || !window.ggbApplet) return;
      try {
        const state = window.ggbApplet.getBase64();
        localStorage.setItem(storageKey, state);
        // Update timestamp for this state
        localStorage.setItem(storageKey + '-timestamp', Date.now().toString());
      } catch (e) {
        // If quota exceeded, try cleaning up old states and retry
        if (e.name === 'QuotaExceededError') {
          cleanupOldStates();
          try {
            const state = window.ggbApplet.getBase64();
            localStorage.setItem(storageKey, state);
            localStorage.setItem(storageKey + '-timestamp', Date.now().toString());
          } catch (retryError) {
            // Still failed after cleanup - silently give up
          }
        }
      }
    }

    function cleanupOldStates() {
      try {
        // Find all GeoGebra CAS states with timestamps
        const casStates = [];
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          if (key && key.startsWith('ggb-cas-state-') && key.endsWith('-timestamp')) {
            const stateKey = key.replace('-timestamp', '');
            const timestamp = parseInt(localStorage.getItem(key) || '0', 10);
            casStates.push({ key: stateKey, timestamp: timestamp });
          }
        }
        
        // Sort by timestamp (oldest first)
        casStates.sort((a, b) => a.timestamp - b.timestamp);
        
        // Delete oldest 25% of states (minimum 1, maximum 10)
        const numToDelete = Math.max(1, Math.min(10, Math.floor(casStates.length * 0.25)));
        for (let i = 0; i < numToDelete && i < casStates.length; i++) {
          localStorage.removeItem(casStates[i].key);
          localStorage.removeItem(casStates[i].key + '-timestamp');
        }
      } catch (e) {
        // Cleanup failed - silently continue
      }
    }

    function restoreState() {
      if (!ggbReady || !window.ggbApplet) return;
      try {
        const savedState = localStorage.getItem(storageKey);
        if (savedState) {
          window.ggbApplet.setBase64(savedState);
          // Re-apply custom toolbar after restoring state to prevent it from being overwritten
          setTimeout(() => {
            if (window.ggbApplet && window.ggbApplet.setCustomToolBar) {
              window.ggbApplet.setCustomToolBar("1001 | 1002 | 1007 | 1010 | 6");
            }
          }, 50);
        }
      } catch (e) {
        // Silently fail if restore fails
      }
    }

    const $dlg = $("#dialog-ggb-cas-250aaa33").dialog({
      autoOpen: false,
      width: 440, height: 680,
      resizable: true, draggable: true,
      position: { my: "center", at: "center", of: window },
      resize: () => window.requestAnimationFrame(applySize),
      open: function() {
        if (!ggbReady) {
          new GGBApplet({
            appName: "classic", id: "ggb-cas-250aaa33",
            width: 400, height: 600,
            perspective: "C", language: "nb",
            showToolBar: true, showAlgebraInput: false,
            borderRadius: 8, enableRightClick: true, showKeyboardOnFocus: false,
            customToolBar: "1001 | 1002 | 1007 | 1010 | 6",
            appletOnLoad: () => { 
              ggbReady = true; 
              applySize();
              // Restore state after a short delay to ensure GeoGebra is fully initialized
              setTimeout(restoreState, 100);
            }
          }, true).inject("ggb-cas-250aaa33");
        } else {
          applySize();
        }
      },
      close: function() {
        // Save state when dialog is closed
        saveState();
      }
    });

    // Add refresh button to title bar
    const titleBar = $dlg.parent().find('.ui-dialog-titlebar');
    const refreshBtn = $('<button type="button" class="ggb-reset-btn" title="Start på nytt (slett lagret innhold)"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.65 2.35C12.2 0.9 10.21 0 8 0 3.58 0 0.01 3.58 0.01 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L9 7h7V0l-2.35 2.35z" fill="currentColor"/></svg></button>');
    refreshBtn.on('click', function() {
      if (confirm('Er du sikker på at du vil slette lagret innhold og starte på nytt?')) {
        try {
          localStorage.removeItem(storageKey);
          localStorage.removeItem(storageKey + '-timestamp');
          if (ggbReady && window.ggbApplet) {
            // Clear the container
            $("#ggb-cas-250aaa33").empty();
            // Reset the flag
            ggbReady = false;
            // Recreate the applet from scratch
            new GGBApplet({
              appName: "classic", id: "ggb-cas-250aaa33",
              width: 400, height: 600,
              perspective: "C", language: "nb",
              showToolBar: true, showAlgebraInput: false,
              borderRadius: 8, enableRightClick: true, showKeyboardOnFocus: false,
              customToolBar: "1001 | 1002 | 1007 | 1010 | 6",
              appletOnLoad: () => { 
                ggbReady = true; 
                applySize();
              }
            }, true).inject("ggb-cas-250aaa33");
          }
        } catch (e) {
          console.error('Failed to reset:', e);
        }
      }
    });
    titleBar.append(refreshBtn);

    // Save state when page is unloaded (refresh, navigate away, close tab)
    $(window).on('beforeunload', function() {
      if ($dlg.dialog('isOpen')) {
        saveState();
      }
    });

    // Prevent background scroll when GeoGebra applet is active
    let scrollLocked = false;
    let lockedScrollTop = 0;
    let keyHandler = null;
    let wheelHandler = null;
    let scrollHandler = null;
    
    function lockScroll() {
      if (scrollLocked) return;
      scrollLocked = true;
      lockedScrollTop = window.pageYOffset || document.documentElement.scrollTop || 0;
      
      // Instead of preventing keys, monitor and restore scroll position
      scrollHandler = () => {
        if (scrollLocked) {
          const currentScroll = window.pageYOffset || document.documentElement.scrollTop || 0;
          if (currentScroll !== lockedScrollTop) {
            window.scrollTo(0, lockedScrollTop);
          }
        }
      };
      
      // Prevent wheel scrolling on the page background
      wheelHandler = (e) => {
        const dialogElement = e.target.closest('.ui-dialog');
        if (dialogElement) {
          // Allow scrolling within dialog elements that can scroll
          let target = e.target;
          while (target && target !== dialogElement) {
            const overflow = window.getComputedStyle(target).overflow;
            if (overflow === 'auto' || overflow === 'scroll') {
              return; // Allow internal scrolling
            }
            target = target.parentElement;
          }
          // Prevent page scroll but don't stop the event from reaching GeoGebra
          if (!e.target.closest('#ggb-cas-250aaa33')) {
            e.preventDefault();
            e.stopPropagation();
          }
        }
      };
      
      // Monitor scroll events to maintain position
      window.addEventListener('scroll', scrollHandler, { passive: true });
      document.addEventListener('wheel', wheelHandler, { capture: true, passive: false });
    }
    
    function unlockScroll() {
      if (!scrollLocked) return;
      scrollLocked = false;
      
      if (scrollHandler) {
        window.removeEventListener('scroll', scrollHandler);
        scrollHandler = null;
      }
      if (wheelHandler) {
        document.removeEventListener('wheel', wheelHandler, { capture: true });
        wheelHandler = null;
      }
    }
    
    // Monitor GeoGebra applet focus/interaction to control scroll lock
    function bindScrollLock() {
      const ggbContainer = document.getElementById('ggb-cas-250aaa33');
      if (!ggbContainer) {
        setTimeout(bindScrollLock, 300);
        return;
      }
      
      // Look for the actual GeoGebra canvas/applet elements
      const ggbApplet = ggbContainer.querySelector('canvas') || 
                       ggbContainer.querySelector('.ggbApplet') ||
                       ggbContainer.querySelector('[id^="ggbApplet"]') ||
                       ggbContainer;
      
      if (ggbApplet) {
        // Lock scroll when interacting with GeoGebra
        ggbApplet.addEventListener('mousedown', lockScroll);
        ggbApplet.addEventListener('focus', lockScroll);
        ggbApplet.addEventListener('click', lockScroll);
        
        // Also monitor the container for any focus events
        ggbContainer.addEventListener('focusin', lockScroll);
        ggbContainer.addEventListener('mousedown', lockScroll);
        
        // Unlock when clicking outside or losing focus
        document.addEventListener('click', (e) => {
          if (!ggbContainer.contains(e.target) && !e.target.closest('.ui-dialog')) {
            unlockScroll();
          }
        });
        
        ggbContainer.addEventListener('focusout', (e) => {
          // Small delay to check if focus moved outside the container
          setTimeout(() => {
            if (!ggbContainer.contains(document.activeElement)) {
              unlockScroll();
            }
          }, 100);
        });
      }
    }
    
    // Start monitoring after GeoGebra is loaded
    setTimeout(bindScrollLock, 1000);
    
    // Cleanup on dialog close
    $dlg.on('dialogclose', unlockScroll);

    $("#button-ggb-cas-250aaa33").button()
      .on("click touchend pointerup", e => {
        e.preventDefault();
        $("#dialog-ggb-cas-250aaa33").dialog("open");
      });
  });
})();
</script>

        </section>
<section id="norwegian-text">
<h2>Norwegian Text<a class="headerlink" href="#norwegian-text" title="Link to this heading">#</a></h2>
<p>Using Norwegian text for button and title:</p>


<meta name="viewport" content="width=device-width, initial-scale=1">

<button id="button-ggb-cas-03eaa464" class="ggb-cas-button">"Åpne</button>
<div id="dialog-ggb-cas-03eaa464" title="kalkulator" "Matematisk kalkulator"" style="display:none;">
    <div id="ggb-cas-03eaa464" class="ggb-window"></div>
</div>

<style>
.ui-resizable-handle { min-width:16px;min-height:16px; }
.ui-dialog-content{padding:0!important;}
.ggb-window       {width:100%!important;height:100%!important;box-sizing:border-box;}
.ggb-cas-button   {margin-top: 1em; margin-bottom: 1em;}
.ggb-reset-btn {
  position: absolute;
  right: 2.5em;
  top: 50%;
  transform: translateY(-50%);
  width: 2em;
  height: 2em;
  padding: 0.25em;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  border-radius: 4px;
  background: transparent;
  cursor: pointer;
  transition: background-color 0.2s, opacity 0.2s;
  opacity: 0.7;
}
.ggb-reset-btn:hover {
  opacity: 1;
  background-color: rgba(0, 0, 0, 0.1);
}
[data-theme="dark"] .ggb-reset-btn:hover,
html[data-theme="dark"] .ggb-reset-btn:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.ggb-reset-btn svg {
  color: inherit;
}
</style>

<script>
(function() {
  $(function() {
    let ggbReady = false;
    const storageKey = 'ggb-cas-state-ggb-cas-03eaa464';

    function applySize() {
      if (!ggbReady) return;
      const w = $("#ggb-cas-03eaa464").width(),
            h = $("#ggb-cas-03eaa464").height();
      window.ggbApplet.setSize(Math.round(w), Math.round(h));
    }

    function saveState() {
      if (!ggbReady || !window.ggbApplet) return;
      try {
        const state = window.ggbApplet.getBase64();
        localStorage.setItem(storageKey, state);
        // Update timestamp for this state
        localStorage.setItem(storageKey + '-timestamp', Date.now().toString());
      } catch (e) {
        // If quota exceeded, try cleaning up old states and retry
        if (e.name === 'QuotaExceededError') {
          cleanupOldStates();
          try {
            const state = window.ggbApplet.getBase64();
            localStorage.setItem(storageKey, state);
            localStorage.setItem(storageKey + '-timestamp', Date.now().toString());
          } catch (retryError) {
            // Still failed after cleanup - silently give up
          }
        }
      }
    }

    function cleanupOldStates() {
      try {
        // Find all GeoGebra CAS states with timestamps
        const casStates = [];
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          if (key && key.startsWith('ggb-cas-state-') && key.endsWith('-timestamp')) {
            const stateKey = key.replace('-timestamp', '');
            const timestamp = parseInt(localStorage.getItem(key) || '0', 10);
            casStates.push({ key: stateKey, timestamp: timestamp });
          }
        }
        
        // Sort by timestamp (oldest first)
        casStates.sort((a, b) => a.timestamp - b.timestamp);
        
        // Delete oldest 25% of states (minimum 1, maximum 10)
        const numToDelete = Math.max(1, Math.min(10, Math.floor(casStates.length * 0.25)));
        for (let i = 0; i < numToDelete && i < casStates.length; i++) {
          localStorage.removeItem(casStates[i].key);
          localStorage.removeItem(casStates[i].key + '-timestamp');
        }
      } catch (e) {
        // Cleanup failed - silently continue
      }
    }

    function restoreState() {
      if (!ggbReady || !window.ggbApplet) return;
      try {
        const savedState = localStorage.getItem(storageKey);
        if (savedState) {
          window.ggbApplet.setBase64(savedState);
          // Re-apply custom toolbar after restoring state to prevent it from being overwritten
          setTimeout(() => {
            if (window.ggbApplet && window.ggbApplet.setCustomToolBar) {
              window.ggbApplet.setCustomToolBar("1001 | 1002 | 1007 | 1010 | 6");
            }
          }, 50);
        }
      } catch (e) {
        // Silently fail if restore fails
      }
    }

    const $dlg = $("#dialog-ggb-cas-03eaa464").dialog({
      autoOpen: false,
      width: 540, height: 730,
      resizable: true, draggable: true,
      position: { my: "center", at: "center", of: window },
      resize: () => window.requestAnimationFrame(applySize),
      open: function() {
        if (!ggbReady) {
          new GGBApplet({
            appName: "classic", id: "ggb-cas-03eaa464",
            width: 500, height: 650,
            perspective: "C", language: "nb",
            showToolBar: true, showAlgebraInput: false,
            borderRadius: 8, enableRightClick: true, showKeyboardOnFocus: false,
            customToolBar: "1001 | 1002 | 1007 | 1010 | 6",
            appletOnLoad: () => { 
              ggbReady = true; 
              applySize();
              // Restore state after a short delay to ensure GeoGebra is fully initialized
              setTimeout(restoreState, 100);
            }
          }, true).inject("ggb-cas-03eaa464");
        } else {
          applySize();
        }
      },
      close: function() {
        // Save state when dialog is closed
        saveState();
      }
    });

    // Add refresh button to title bar
    const titleBar = $dlg.parent().find('.ui-dialog-titlebar');
    const refreshBtn = $('<button type="button" class="ggb-reset-btn" title="Start på nytt (slett lagret innhold)"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.65 2.35C12.2 0.9 10.21 0 8 0 3.58 0 0.01 3.58 0.01 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L9 7h7V0l-2.35 2.35z" fill="currentColor"/></svg></button>');
    refreshBtn.on('click', function() {
      if (confirm('Er du sikker på at du vil slette lagret innhold og starte på nytt?')) {
        try {
          localStorage.removeItem(storageKey);
          localStorage.removeItem(storageKey + '-timestamp');
          if (ggbReady && window.ggbApplet) {
            // Clear the container
            $("#ggb-cas-03eaa464").empty();
            // Reset the flag
            ggbReady = false;
            // Recreate the applet from scratch
            new GGBApplet({
              appName: "classic", id: "ggb-cas-03eaa464",
              width: 500, height: 650,
              perspective: "C", language: "nb",
              showToolBar: true, showAlgebraInput: false,
              borderRadius: 8, enableRightClick: true, showKeyboardOnFocus: false,
              customToolBar: "1001 | 1002 | 1007 | 1010 | 6",
              appletOnLoad: () => { 
                ggbReady = true; 
                applySize();
              }
            }, true).inject("ggb-cas-03eaa464");
          }
        } catch (e) {
          console.error('Failed to reset:', e);
        }
      }
    });
    titleBar.append(refreshBtn);

    // Save state when page is unloaded (refresh, navigate away, close tab)
    $(window).on('beforeunload', function() {
      if ($dlg.dialog('isOpen')) {
        saveState();
      }
    });

    // Prevent background scroll when GeoGebra applet is active
    let scrollLocked = false;
    let lockedScrollTop = 0;
    let keyHandler = null;
    let wheelHandler = null;
    let scrollHandler = null;
    
    function lockScroll() {
      if (scrollLocked) return;
      scrollLocked = true;
      lockedScrollTop = window.pageYOffset || document.documentElement.scrollTop || 0;
      
      // Instead of preventing keys, monitor and restore scroll position
      scrollHandler = () => {
        if (scrollLocked) {
          const currentScroll = window.pageYOffset || document.documentElement.scrollTop || 0;
          if (currentScroll !== lockedScrollTop) {
            window.scrollTo(0, lockedScrollTop);
          }
        }
      };
      
      // Prevent wheel scrolling on the page background
      wheelHandler = (e) => {
        const dialogElement = e.target.closest('.ui-dialog');
        if (dialogElement) {
          // Allow scrolling within dialog elements that can scroll
          let target = e.target;
          while (target && target !== dialogElement) {
            const overflow = window.getComputedStyle(target).overflow;
            if (overflow === 'auto' || overflow === 'scroll') {
              return; // Allow internal scrolling
            }
            target = target.parentElement;
          }
          // Prevent page scroll but don't stop the event from reaching GeoGebra
          if (!e.target.closest('#ggb-cas-03eaa464')) {
            e.preventDefault();
            e.stopPropagation();
          }
        }
      };
      
      // Monitor scroll events to maintain position
      window.addEventListener('scroll', scrollHandler, { passive: true });
      document.addEventListener('wheel', wheelHandler, { capture: true, passive: false });
    }
    
    function unlockScroll() {
      if (!scrollLocked) return;
      scrollLocked = false;
      
      if (scrollHandler) {
        window.removeEventListener('scroll', scrollHandler);
        scrollHandler = null;
      }
      if (wheelHandler) {
        document.removeEventListener('wheel', wheelHandler, { capture: true });
        wheelHandler = null;
      }
    }
    
    // Monitor GeoGebra applet focus/interaction to control scroll lock
    function bindScrollLock() {
      const ggbContainer = document.getElementById('ggb-cas-03eaa464');
      if (!ggbContainer) {
        setTimeout(bindScrollLock, 300);
        return;
      }
      
      // Look for the actual GeoGebra canvas/applet elements
      const ggbApplet = ggbContainer.querySelector('canvas') || 
                       ggbContainer.querySelector('.ggbApplet') ||
                       ggbContainer.querySelector('[id^="ggbApplet"]') ||
                       ggbContainer;
      
      if (ggbApplet) {
        // Lock scroll when interacting with GeoGebra
        ggbApplet.addEventListener('mousedown', lockScroll);
        ggbApplet.addEventListener('focus', lockScroll);
        ggbApplet.addEventListener('click', lockScroll);
        
        // Also monitor the container for any focus events
        ggbContainer.addEventListener('focusin', lockScroll);
        ggbContainer.addEventListener('mousedown', lockScroll);
        
        // Unlock when clicking outside or losing focus
        document.addEventListener('click', (e) => {
          if (!ggbContainer.contains(e.target) && !e.target.closest('.ui-dialog')) {
            unlockScroll();
          }
        });
        
        ggbContainer.addEventListener('focusout', (e) => {
          // Small delay to check if focus moved outside the container
          setTimeout(() => {
            if (!ggbContainer.contains(document.activeElement)) {
              unlockScroll();
            }
          }, 100);
        });
      }
    }
    
    // Start monitoring after GeoGebra is loaded
    setTimeout(bindScrollLock, 1000);
    
    // Cleanup on dialog close
    $dlg.on('dialogclose', unlockScroll);

    $("#button-ggb-cas-03eaa464").button()
      .on("click touchend pointerup", e => {
        e.preventDefault();
        $("#dialog-ggb-cas-03eaa464").dialog("open");
      });
  });
})();
</script>

        </section>
<section id="sidebar-layout">
<h2>Sidebar Layout<a class="headerlink" href="#sidebar-layout" title="Link to this heading">#</a></h2>
<p>Float the button to the right side of the page:</p>

<div class="sidebar-cas">
<meta name="viewport" content="width=device-width, initial-scale=1">

<button id="button-ggb-cas-2abd38f1" class="ggb-cas-button">"CAS"</button>
<div id="dialog-ggb-cas-2abd38f1" title=""Calculator"" style="display:none;">
    <div id="ggb-cas-2abd38f1" class="ggb-window"></div>
</div>

<style>
.ui-resizable-handle { min-width:16px;min-height:16px; }
.ui-dialog-content{padding:0!important;}
.ggb-window       {width:100%!important;height:100%!important;box-sizing:border-box;}
.ggb-cas-button   {margin-top: 1em; margin-bottom: 1em;}
.ggb-reset-btn {
  position: absolute;
  right: 2.5em;
  top: 50%;
  transform: translateY(-50%);
  width: 2em;
  height: 2em;
  padding: 0.25em;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  border-radius: 4px;
  background: transparent;
  cursor: pointer;
  transition: background-color 0.2s, opacity 0.2s;
  opacity: 0.7;
}
.ggb-reset-btn:hover {
  opacity: 1;
  background-color: rgba(0, 0, 0, 0.1);
}
[data-theme="dark"] .ggb-reset-btn:hover,
html[data-theme="dark"] .ggb-reset-btn:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.ggb-reset-btn svg {
  color: inherit;
}
</style>

<script>
(function() {
  $(function() {
    let ggbReady = false;
    const storageKey = 'ggb-cas-state-ggb-cas-2abd38f1';

    function applySize() {
      if (!ggbReady) return;
      const w = $("#ggb-cas-2abd38f1").width(),
            h = $("#ggb-cas-2abd38f1").height();
      window.ggbApplet.setSize(Math.round(w), Math.round(h));
    }

    function saveState() {
      if (!ggbReady || !window.ggbApplet) return;
      try {
        const state = window.ggbApplet.getBase64();
        localStorage.setItem(storageKey, state);
        // Update timestamp for this state
        localStorage.setItem(storageKey + '-timestamp', Date.now().toString());
      } catch (e) {
        // If quota exceeded, try cleaning up old states and retry
        if (e.name === 'QuotaExceededError') {
          cleanupOldStates();
          try {
            const state = window.ggbApplet.getBase64();
            localStorage.setItem(storageKey, state);
            localStorage.setItem(storageKey + '-timestamp', Date.now().toString());
          } catch (retryError) {
            // Still failed after cleanup - silently give up
          }
        }
      }
    }

    function cleanupOldStates() {
      try {
        // Find all GeoGebra CAS states with timestamps
        const casStates = [];
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          if (key && key.startsWith('ggb-cas-state-') && key.endsWith('-timestamp')) {
            const stateKey = key.replace('-timestamp', '');
            const timestamp = parseInt(localStorage.getItem(key) || '0', 10);
            casStates.push({ key: stateKey, timestamp: timestamp });
          }
        }
        
        // Sort by timestamp (oldest first)
        casStates.sort((a, b) => a.timestamp - b.timestamp);
        
        // Delete oldest 25% of states (minimum 1, maximum 10)
        const numToDelete = Math.max(1, Math.min(10, Math.floor(casStates.length * 0.25)));
        for (let i = 0; i < numToDelete && i < casStates.length; i++) {
          localStorage.removeItem(casStates[i].key);
          localStorage.removeItem(casStates[i].key + '-timestamp');
        }
      } catch (e) {
        // Cleanup failed - silently continue
      }
    }

    function restoreState() {
      if (!ggbReady || !window.ggbApplet) return;
      try {
        const savedState = localStorage.getItem(storageKey);
        if (savedState) {
          window.ggbApplet.setBase64(savedState);
          // Re-apply custom toolbar after restoring state to prevent it from being overwritten
          setTimeout(() => {
            if (window.ggbApplet && window.ggbApplet.setCustomToolBar) {
              window.ggbApplet.setCustomToolBar("1001 | 1002 | 1007 | 1010 | 6");
            }
          }, 50);
        }
      } catch (e) {
        // Silently fail if restore fails
      }
    }

    const $dlg = $("#dialog-ggb-cas-2abd38f1").dialog({
      autoOpen: false,
      width: 390, height: 580,
      resizable: true, draggable: true,
      position: { my: "center", at: "center", of: window },
      resize: () => window.requestAnimationFrame(applySize),
      open: function() {
        if (!ggbReady) {
          new GGBApplet({
            appName: "classic", id: "ggb-cas-2abd38f1",
            width: 350, height: 500,
            perspective: "C", language: "nb",
            showToolBar: true, showAlgebraInput: false,
            borderRadius: 8, enableRightClick: true, showKeyboardOnFocus: false,
            customToolBar: "1001 | 1002 | 1007 | 1010 | 6",
            appletOnLoad: () => { 
              ggbReady = true; 
              applySize();
              // Restore state after a short delay to ensure GeoGebra is fully initialized
              setTimeout(restoreState, 100);
            }
          }, true).inject("ggb-cas-2abd38f1");
        } else {
          applySize();
        }
      },
      close: function() {
        // Save state when dialog is closed
        saveState();
      }
    });

    // Add refresh button to title bar
    const titleBar = $dlg.parent().find('.ui-dialog-titlebar');
    const refreshBtn = $('<button type="button" class="ggb-reset-btn" title="Start på nytt (slett lagret innhold)"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.65 2.35C12.2 0.9 10.21 0 8 0 3.58 0 0.01 3.58 0.01 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L9 7h7V0l-2.35 2.35z" fill="currentColor"/></svg></button>');
    refreshBtn.on('click', function() {
      if (confirm('Er du sikker på at du vil slette lagret innhold og starte på nytt?')) {
        try {
          localStorage.removeItem(storageKey);
          localStorage.removeItem(storageKey + '-timestamp');
          if (ggbReady && window.ggbApplet) {
            // Clear the container
            $("#ggb-cas-2abd38f1").empty();
            // Reset the flag
            ggbReady = false;
            // Recreate the applet from scratch
            new GGBApplet({
              appName: "classic", id: "ggb-cas-2abd38f1",
              width: 350, height: 500,
              perspective: "C", language: "nb",
              showToolBar: true, showAlgebraInput: false,
              borderRadius: 8, enableRightClick: true, showKeyboardOnFocus: false,
              customToolBar: "1001 | 1002 | 1007 | 1010 | 6",
              appletOnLoad: () => { 
                ggbReady = true; 
                applySize();
              }
            }, true).inject("ggb-cas-2abd38f1");
          }
        } catch (e) {
          console.error('Failed to reset:', e);
        }
      }
    });
    titleBar.append(refreshBtn);

    // Save state when page is unloaded (refresh, navigate away, close tab)
    $(window).on('beforeunload', function() {
      if ($dlg.dialog('isOpen')) {
        saveState();
      }
    });

    // Prevent background scroll when GeoGebra applet is active
    let scrollLocked = false;
    let lockedScrollTop = 0;
    let keyHandler = null;
    let wheelHandler = null;
    let scrollHandler = null;
    
    function lockScroll() {
      if (scrollLocked) return;
      scrollLocked = true;
      lockedScrollTop = window.pageYOffset || document.documentElement.scrollTop || 0;
      
      // Instead of preventing keys, monitor and restore scroll position
      scrollHandler = () => {
        if (scrollLocked) {
          const currentScroll = window.pageYOffset || document.documentElement.scrollTop || 0;
          if (currentScroll !== lockedScrollTop) {
            window.scrollTo(0, lockedScrollTop);
          }
        }
      };
      
      // Prevent wheel scrolling on the page background
      wheelHandler = (e) => {
        const dialogElement = e.target.closest('.ui-dialog');
        if (dialogElement) {
          // Allow scrolling within dialog elements that can scroll
          let target = e.target;
          while (target && target !== dialogElement) {
            const overflow = window.getComputedStyle(target).overflow;
            if (overflow === 'auto' || overflow === 'scroll') {
              return; // Allow internal scrolling
            }
            target = target.parentElement;
          }
          // Prevent page scroll but don't stop the event from reaching GeoGebra
          if (!e.target.closest('#ggb-cas-2abd38f1')) {
            e.preventDefault();
            e.stopPropagation();
          }
        }
      };
      
      // Monitor scroll events to maintain position
      window.addEventListener('scroll', scrollHandler, { passive: true });
      document.addEventListener('wheel', wheelHandler, { capture: true, passive: false });
    }
    
    function unlockScroll() {
      if (!scrollLocked) return;
      scrollLocked = false;
      
      if (scrollHandler) {
        window.removeEventListener('scroll', scrollHandler);
        scrollHandler = null;
      }
      if (wheelHandler) {
        document.removeEventListener('wheel', wheelHandler, { capture: true });
        wheelHandler = null;
      }
    }
    
    // Monitor GeoGebra applet focus/interaction to control scroll lock
    function bindScrollLock() {
      const ggbContainer = document.getElementById('ggb-cas-2abd38f1');
      if (!ggbContainer) {
        setTimeout(bindScrollLock, 300);
        return;
      }
      
      // Look for the actual GeoGebra canvas/applet elements
      const ggbApplet = ggbContainer.querySelector('canvas') || 
                       ggbContainer.querySelector('.ggbApplet') ||
                       ggbContainer.querySelector('[id^="ggbApplet"]') ||
                       ggbContainer;
      
      if (ggbApplet) {
        // Lock scroll when interacting with GeoGebra
        ggbApplet.addEventListener('mousedown', lockScroll);
        ggbApplet.addEventListener('focus', lockScroll);
        ggbApplet.addEventListener('click', lockScroll);
        
        // Also monitor the container for any focus events
        ggbContainer.addEventListener('focusin', lockScroll);
        ggbContainer.addEventListener('mousedown', lockScroll);
        
        // Unlock when clicking outside or losing focus
        document.addEventListener('click', (e) => {
          if (!ggbContainer.contains(e.target) && !e.target.closest('.ui-dialog')) {
            unlockScroll();
          }
        });
        
        ggbContainer.addEventListener('focusout', (e) => {
          // Small delay to check if focus moved outside the container
          setTimeout(() => {
            if (!ggbContainer.contains(document.activeElement)) {
              unlockScroll();
            }
          }, 100);
        });
      }
    }
    
    // Start monitoring after GeoGebra is loaded
    setTimeout(bindScrollLock, 1000);
    
    // Cleanup on dialog close
    $dlg.on('dialogclose', unlockScroll);

    $("#button-ggb-cas-2abd38f1").button()
      .on("click touchend pointerup", e => {
        e.preventDefault();
        $("#dialog-ggb-cas-2abd38f1").dialog("open");
      });
  });
})();
</script>
</div>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.</p>
<p>The sidebar CAS button should float to the right of this text. This demonstrates how you can integrate the CAS calculator seamlessly into your content without disrupting the flow.</p>
</section>
<section id="multiple-cas-windows">
<h2>Multiple CAS Windows<a class="headerlink" href="#multiple-cas-windows" title="Link to this heading">#</a></h2>
<p>You can have multiple CAS windows on the same page:</p>


<meta name="viewport" content="width=device-width, initial-scale=1">

<button id="button-ggb-cas-54dc8128" class="ggb-cas-button">"CAS</button>
<div id="dialog-ggb-cas-54dc8128" title="Window 1" "Calculator 1"" style="display:none;">
    <div id="ggb-cas-54dc8128" class="ggb-window"></div>
</div>

<style>
.ui-resizable-handle { min-width:16px;min-height:16px; }
.ui-dialog-content{padding:0!important;}
.ggb-window       {width:100%!important;height:100%!important;box-sizing:border-box;}
.ggb-cas-button   {margin-top: 1em; margin-bottom: 1em;}
.ggb-reset-btn {
  position: absolute;
  right: 2.5em;
  top: 50%;
  transform: translateY(-50%);
  width: 2em;
  height: 2em;
  padding: 0.25em;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  border-radius: 4px;
  background: transparent;
  cursor: pointer;
  transition: background-color 0.2s, opacity 0.2s;
  opacity: 0.7;
}
.ggb-reset-btn:hover {
  opacity: 1;
  background-color: rgba(0, 0, 0, 0.1);
}
[data-theme="dark"] .ggb-reset-btn:hover,
html[data-theme="dark"] .ggb-reset-btn:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.ggb-reset-btn svg {
  color: inherit;
}
</style>

<script>
(function() {
  $(function() {
    let ggbReady = false;
    const storageKey = 'ggb-cas-state-ggb-cas-54dc8128';

    function applySize() {
      if (!ggbReady) return;
      const w = $("#ggb-cas-54dc8128").width(),
            h = $("#ggb-cas-54dc8128").height();
      window.ggbApplet.setSize(Math.round(w), Math.round(h));
    }

    function saveState() {
      if (!ggbReady || !window.ggbApplet) return;
      try {
        const state = window.ggbApplet.getBase64();
        localStorage.setItem(storageKey, state);
        // Update timestamp for this state
        localStorage.setItem(storageKey + '-timestamp', Date.now().toString());
      } catch (e) {
        // If quota exceeded, try cleaning up old states and retry
        if (e.name === 'QuotaExceededError') {
          cleanupOldStates();
          try {
            const state = window.ggbApplet.getBase64();
            localStorage.setItem(storageKey, state);
            localStorage.setItem(storageKey + '-timestamp', Date.now().toString());
          } catch (retryError) {
            // Still failed after cleanup - silently give up
          }
        }
      }
    }

    function cleanupOldStates() {
      try {
        // Find all GeoGebra CAS states with timestamps
        const casStates = [];
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          if (key && key.startsWith('ggb-cas-state-') && key.endsWith('-timestamp')) {
            const stateKey = key.replace('-timestamp', '');
            const timestamp = parseInt(localStorage.getItem(key) || '0', 10);
            casStates.push({ key: stateKey, timestamp: timestamp });
          }
        }
        
        // Sort by timestamp (oldest first)
        casStates.sort((a, b) => a.timestamp - b.timestamp);
        
        // Delete oldest 25% of states (minimum 1, maximum 10)
        const numToDelete = Math.max(1, Math.min(10, Math.floor(casStates.length * 0.25)));
        for (let i = 0; i < numToDelete && i < casStates.length; i++) {
          localStorage.removeItem(casStates[i].key);
          localStorage.removeItem(casStates[i].key + '-timestamp');
        }
      } catch (e) {
        // Cleanup failed - silently continue
      }
    }

    function restoreState() {
      if (!ggbReady || !window.ggbApplet) return;
      try {
        const savedState = localStorage.getItem(storageKey);
        if (savedState) {
          window.ggbApplet.setBase64(savedState);
          // Re-apply custom toolbar after restoring state to prevent it from being overwritten
          setTimeout(() => {
            if (window.ggbApplet && window.ggbApplet.setCustomToolBar) {
              window.ggbApplet.setCustomToolBar("1001 | 1002 | 1007 | 1010 | 6");
            }
          }, 50);
        }
      } catch (e) {
        // Silently fail if restore fails
      }
    }

    const $dlg = $("#dialog-ggb-cas-54dc8128").dialog({
      autoOpen: false,
      width: 440, height: 580,
      resizable: true, draggable: true,
      position: { my: "center", at: "center", of: window },
      resize: () => window.requestAnimationFrame(applySize),
      open: function() {
        if (!ggbReady) {
          new GGBApplet({
            appName: "classic", id: "ggb-cas-54dc8128",
            width: 400, height: 500,
            perspective: "C", language: "nb",
            showToolBar: true, showAlgebraInput: false,
            borderRadius: 8, enableRightClick: true, showKeyboardOnFocus: false,
            customToolBar: "1001 | 1002 | 1007 | 1010 | 6",
            appletOnLoad: () => { 
              ggbReady = true; 
              applySize();
              // Restore state after a short delay to ensure GeoGebra is fully initialized
              setTimeout(restoreState, 100);
            }
          }, true).inject("ggb-cas-54dc8128");
        } else {
          applySize();
        }
      },
      close: function() {
        // Save state when dialog is closed
        saveState();
      }
    });

    // Add refresh button to title bar
    const titleBar = $dlg.parent().find('.ui-dialog-titlebar');
    const refreshBtn = $('<button type="button" class="ggb-reset-btn" title="Start på nytt (slett lagret innhold)"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.65 2.35C12.2 0.9 10.21 0 8 0 3.58 0 0.01 3.58 0.01 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L9 7h7V0l-2.35 2.35z" fill="currentColor"/></svg></button>');
    refreshBtn.on('click', function() {
      if (confirm('Er du sikker på at du vil slette lagret innhold og starte på nytt?')) {
        try {
          localStorage.removeItem(storageKey);
          localStorage.removeItem(storageKey + '-timestamp');
          if (ggbReady && window.ggbApplet) {
            // Clear the container
            $("#ggb-cas-54dc8128").empty();
            // Reset the flag
            ggbReady = false;
            // Recreate the applet from scratch
            new GGBApplet({
              appName: "classic", id: "ggb-cas-54dc8128",
              width: 400, height: 500,
              perspective: "C", language: "nb",
              showToolBar: true, showAlgebraInput: false,
              borderRadius: 8, enableRightClick: true, showKeyboardOnFocus: false,
              customToolBar: "1001 | 1002 | 1007 | 1010 | 6",
              appletOnLoad: () => { 
                ggbReady = true; 
                applySize();
              }
            }, true).inject("ggb-cas-54dc8128");
          }
        } catch (e) {
          console.error('Failed to reset:', e);
        }
      }
    });
    titleBar.append(refreshBtn);

    // Save state when page is unloaded (refresh, navigate away, close tab)
    $(window).on('beforeunload', function() {
      if ($dlg.dialog('isOpen')) {
        saveState();
      }
    });

    // Prevent background scroll when GeoGebra applet is active
    let scrollLocked = false;
    let lockedScrollTop = 0;
    let keyHandler = null;
    let wheelHandler = null;
    let scrollHandler = null;
    
    function lockScroll() {
      if (scrollLocked) return;
      scrollLocked = true;
      lockedScrollTop = window.pageYOffset || document.documentElement.scrollTop || 0;
      
      // Instead of preventing keys, monitor and restore scroll position
      scrollHandler = () => {
        if (scrollLocked) {
          const currentScroll = window.pageYOffset || document.documentElement.scrollTop || 0;
          if (currentScroll !== lockedScrollTop) {
            window.scrollTo(0, lockedScrollTop);
          }
        }
      };
      
      // Prevent wheel scrolling on the page background
      wheelHandler = (e) => {
        const dialogElement = e.target.closest('.ui-dialog');
        if (dialogElement) {
          // Allow scrolling within dialog elements that can scroll
          let target = e.target;
          while (target && target !== dialogElement) {
            const overflow = window.getComputedStyle(target).overflow;
            if (overflow === 'auto' || overflow === 'scroll') {
              return; // Allow internal scrolling
            }
            target = target.parentElement;
          }
          // Prevent page scroll but don't stop the event from reaching GeoGebra
          if (!e.target.closest('#ggb-cas-54dc8128')) {
            e.preventDefault();
            e.stopPropagation();
          }
        }
      };
      
      // Monitor scroll events to maintain position
      window.addEventListener('scroll', scrollHandler, { passive: true });
      document.addEventListener('wheel', wheelHandler, { capture: true, passive: false });
    }
    
    function unlockScroll() {
      if (!scrollLocked) return;
      scrollLocked = false;
      
      if (scrollHandler) {
        window.removeEventListener('scroll', scrollHandler);
        scrollHandler = null;
      }
      if (wheelHandler) {
        document.removeEventListener('wheel', wheelHandler, { capture: true });
        wheelHandler = null;
      }
    }
    
    // Monitor GeoGebra applet focus/interaction to control scroll lock
    function bindScrollLock() {
      const ggbContainer = document.getElementById('ggb-cas-54dc8128');
      if (!ggbContainer) {
        setTimeout(bindScrollLock, 300);
        return;
      }
      
      // Look for the actual GeoGebra canvas/applet elements
      const ggbApplet = ggbContainer.querySelector('canvas') || 
                       ggbContainer.querySelector('.ggbApplet') ||
                       ggbContainer.querySelector('[id^="ggbApplet"]') ||
                       ggbContainer;
      
      if (ggbApplet) {
        // Lock scroll when interacting with GeoGebra
        ggbApplet.addEventListener('mousedown', lockScroll);
        ggbApplet.addEventListener('focus', lockScroll);
        ggbApplet.addEventListener('click', lockScroll);
        
        // Also monitor the container for any focus events
        ggbContainer.addEventListener('focusin', lockScroll);
        ggbContainer.addEventListener('mousedown', lockScroll);
        
        // Unlock when clicking outside or losing focus
        document.addEventListener('click', (e) => {
          if (!ggbContainer.contains(e.target) && !e.target.closest('.ui-dialog')) {
            unlockScroll();
          }
        });
        
        ggbContainer.addEventListener('focusout', (e) => {
          // Small delay to check if focus moved outside the container
          setTimeout(() => {
            if (!ggbContainer.contains(document.activeElement)) {
              unlockScroll();
            }
          }, 100);
        });
      }
    }
    
    // Start monitoring after GeoGebra is loaded
    setTimeout(bindScrollLock, 1000);
    
    // Cleanup on dialog close
    $dlg.on('dialogclose', unlockScroll);

    $("#button-ggb-cas-54dc8128").button()
      .on("click touchend pointerup", e => {
        e.preventDefault();
        $("#dialog-ggb-cas-54dc8128").dialog("open");
      });
  });
})();
</script>

        

<meta name="viewport" content="width=device-width, initial-scale=1">

<button id="button-ggb-cas-8079dfbd" class="ggb-cas-button">"CAS</button>
<div id="dialog-ggb-cas-8079dfbd" title="Window 2" "Calculator 2"" style="display:none;">
    <div id="ggb-cas-8079dfbd" class="ggb-window"></div>
</div>

<style>
.ui-resizable-handle { min-width:16px;min-height:16px; }
.ui-dialog-content{padding:0!important;}
.ggb-window       {width:100%!important;height:100%!important;box-sizing:border-box;}
.ggb-cas-button   {margin-top: 1em; margin-bottom: 1em;}
.ggb-reset-btn {
  position: absolute;
  right: 2.5em;
  top: 50%;
  transform: translateY(-50%);
  width: 2em;
  height: 2em;
  padding: 0.25em;
  margin: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  border-radius: 4px;
  background: transparent;
  cursor: pointer;
  transition: background-color 0.2s, opacity 0.2s;
  opacity: 0.7;
}
.ggb-reset-btn:hover {
  opacity: 1;
  background-color: rgba(0, 0, 0, 0.1);
}
[data-theme="dark"] .ggb-reset-btn:hover,
html[data-theme="dark"] .ggb-reset-btn:hover {
  background-color: rgba(255, 255, 255, 0.1);
}
.ggb-reset-btn svg {
  color: inherit;
}
</style>

<script>
(function() {
  $(function() {
    let ggbReady = false;
    const storageKey = 'ggb-cas-state-ggb-cas-8079dfbd';

    function applySize() {
      if (!ggbReady) return;
      const w = $("#ggb-cas-8079dfbd").width(),
            h = $("#ggb-cas-8079dfbd").height();
      window.ggbApplet.setSize(Math.round(w), Math.round(h));
    }

    function saveState() {
      if (!ggbReady || !window.ggbApplet) return;
      try {
        const state = window.ggbApplet.getBase64();
        localStorage.setItem(storageKey, state);
        // Update timestamp for this state
        localStorage.setItem(storageKey + '-timestamp', Date.now().toString());
      } catch (e) {
        // If quota exceeded, try cleaning up old states and retry
        if (e.name === 'QuotaExceededError') {
          cleanupOldStates();
          try {
            const state = window.ggbApplet.getBase64();
            localStorage.setItem(storageKey, state);
            localStorage.setItem(storageKey + '-timestamp', Date.now().toString());
          } catch (retryError) {
            // Still failed after cleanup - silently give up
          }
        }
      }
    }

    function cleanupOldStates() {
      try {
        // Find all GeoGebra CAS states with timestamps
        const casStates = [];
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          if (key && key.startsWith('ggb-cas-state-') && key.endsWith('-timestamp')) {
            const stateKey = key.replace('-timestamp', '');
            const timestamp = parseInt(localStorage.getItem(key) || '0', 10);
            casStates.push({ key: stateKey, timestamp: timestamp });
          }
        }
        
        // Sort by timestamp (oldest first)
        casStates.sort((a, b) => a.timestamp - b.timestamp);
        
        // Delete oldest 25% of states (minimum 1, maximum 10)
        const numToDelete = Math.max(1, Math.min(10, Math.floor(casStates.length * 0.25)));
        for (let i = 0; i < numToDelete && i < casStates.length; i++) {
          localStorage.removeItem(casStates[i].key);
          localStorage.removeItem(casStates[i].key + '-timestamp');
        }
      } catch (e) {
        // Cleanup failed - silently continue
      }
    }

    function restoreState() {
      if (!ggbReady || !window.ggbApplet) return;
      try {
        const savedState = localStorage.getItem(storageKey);
        if (savedState) {
          window.ggbApplet.setBase64(savedState);
          // Re-apply custom toolbar after restoring state to prevent it from being overwritten
          setTimeout(() => {
            if (window.ggbApplet && window.ggbApplet.setCustomToolBar) {
              window.ggbApplet.setCustomToolBar("1001 | 1002 | 1007 | 1010 | 6");
            }
          }, 50);
        }
      } catch (e) {
        // Silently fail if restore fails
      }
    }

    const $dlg = $("#dialog-ggb-cas-8079dfbd").dialog({
      autoOpen: false,
      width: 440, height: 580,
      resizable: true, draggable: true,
      position: { my: "center", at: "center", of: window },
      resize: () => window.requestAnimationFrame(applySize),
      open: function() {
        if (!ggbReady) {
          new GGBApplet({
            appName: "classic", id: "ggb-cas-8079dfbd",
            width: 400, height: 500,
            perspective: "C", language: "nb",
            showToolBar: true, showAlgebraInput: false,
            borderRadius: 8, enableRightClick: true, showKeyboardOnFocus: false,
            customToolBar: "1001 | 1002 | 1007 | 1010 | 6",
            appletOnLoad: () => { 
              ggbReady = true; 
              applySize();
              // Restore state after a short delay to ensure GeoGebra is fully initialized
              setTimeout(restoreState, 100);
            }
          }, true).inject("ggb-cas-8079dfbd");
        } else {
          applySize();
        }
      },
      close: function() {
        // Save state when dialog is closed
        saveState();
      }
    });

    // Add refresh button to title bar
    const titleBar = $dlg.parent().find('.ui-dialog-titlebar');
    const refreshBtn = $('<button type="button" class="ggb-reset-btn" title="Start på nytt (slett lagret innhold)"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.65 2.35C12.2 0.9 10.21 0 8 0 3.58 0 0.01 3.58 0.01 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L9 7h7V0l-2.35 2.35z" fill="currentColor"/></svg></button>');
    refreshBtn.on('click', function() {
      if (confirm('Er du sikker på at du vil slette lagret innhold og starte på nytt?')) {
        try {
          localStorage.removeItem(storageKey);
          localStorage.removeItem(storageKey + '-timestamp');
          if (ggbReady && window.ggbApplet) {
            // Clear the container
            $("#ggb-cas-8079dfbd").empty();
            // Reset the flag
            ggbReady = false;
            // Recreate the applet from scratch
            new GGBApplet({
              appName: "classic", id: "ggb-cas-8079dfbd",
              width: 400, height: 500,
              perspective: "C", language: "nb",
              showToolBar: true, showAlgebraInput: false,
              borderRadius: 8, enableRightClick: true, showKeyboardOnFocus: false,
              customToolBar: "1001 | 1002 | 1007 | 1010 | 6",
              appletOnLoad: () => { 
                ggbReady = true; 
                applySize();
              }
            }, true).inject("ggb-cas-8079dfbd");
          }
        } catch (e) {
          console.error('Failed to reset:', e);
        }
      }
    });
    titleBar.append(refreshBtn);

    // Save state when page is unloaded (refresh, navigate away, close tab)
    $(window).on('beforeunload', function() {
      if ($dlg.dialog('isOpen')) {
        saveState();
      }
    });

    // Prevent background scroll when GeoGebra applet is active
    let scrollLocked = false;
    let lockedScrollTop = 0;
    let keyHandler = null;
    let wheelHandler = null;
    let scrollHandler = null;
    
    function lockScroll() {
      if (scrollLocked) return;
      scrollLocked = true;
      lockedScrollTop = window.pageYOffset || document.documentElement.scrollTop || 0;
      
      // Instead of preventing keys, monitor and restore scroll position
      scrollHandler = () => {
        if (scrollLocked) {
          const currentScroll = window.pageYOffset || document.documentElement.scrollTop || 0;
          if (currentScroll !== lockedScrollTop) {
            window.scrollTo(0, lockedScrollTop);
          }
        }
      };
      
      // Prevent wheel scrolling on the page background
      wheelHandler = (e) => {
        const dialogElement = e.target.closest('.ui-dialog');
        if (dialogElement) {
          // Allow scrolling within dialog elements that can scroll
          let target = e.target;
          while (target && target !== dialogElement) {
            const overflow = window.getComputedStyle(target).overflow;
            if (overflow === 'auto' || overflow === 'scroll') {
              return; // Allow internal scrolling
            }
            target = target.parentElement;
          }
          // Prevent page scroll but don't stop the event from reaching GeoGebra
          if (!e.target.closest('#ggb-cas-8079dfbd')) {
            e.preventDefault();
            e.stopPropagation();
          }
        }
      };
      
      // Monitor scroll events to maintain position
      window.addEventListener('scroll', scrollHandler, { passive: true });
      document.addEventListener('wheel', wheelHandler, { capture: true, passive: false });
    }
    
    function unlockScroll() {
      if (!scrollLocked) return;
      scrollLocked = false;
      
      if (scrollHandler) {
        window.removeEventListener('scroll', scrollHandler);
        scrollHandler = null;
      }
      if (wheelHandler) {
        document.removeEventListener('wheel', wheelHandler, { capture: true });
        wheelHandler = null;
      }
    }
    
    // Monitor GeoGebra applet focus/interaction to control scroll lock
    function bindScrollLock() {
      const ggbContainer = document.getElementById('ggb-cas-8079dfbd');
      if (!ggbContainer) {
        setTimeout(bindScrollLock, 300);
        return;
      }
      
      // Look for the actual GeoGebra canvas/applet elements
      const ggbApplet = ggbContainer.querySelector('canvas') || 
                       ggbContainer.querySelector('.ggbApplet') ||
                       ggbContainer.querySelector('[id^="ggbApplet"]') ||
                       ggbContainer;
      
      if (ggbApplet) {
        // Lock scroll when interacting with GeoGebra
        ggbApplet.addEventListener('mousedown', lockScroll);
        ggbApplet.addEventListener('focus', lockScroll);
        ggbApplet.addEventListener('click', lockScroll);
        
        // Also monitor the container for any focus events
        ggbContainer.addEventListener('focusin', lockScroll);
        ggbContainer.addEventListener('mousedown', lockScroll);
        
        // Unlock when clicking outside or losing focus
        document.addEventListener('click', (e) => {
          if (!ggbContainer.contains(e.target) && !e.target.closest('.ui-dialog')) {
            unlockScroll();
          }
        });
        
        ggbContainer.addEventListener('focusout', (e) => {
          // Small delay to check if focus moved outside the container
          setTimeout(() => {
            if (!ggbContainer.contains(document.activeElement)) {
              unlockScroll();
            }
          }, 100);
        });
      }
    }
    
    // Start monitoring after GeoGebra is loaded
    setTimeout(bindScrollLock, 1000);
    
    // Cleanup on dialog close
    $dlg.on('dialogclose', unlockScroll);

    $("#button-ggb-cas-8079dfbd").button()
      .on("click touchend pointerup", e => {
        e.preventDefault();
        $("#dialog-ggb-cas-8079dfbd").dialog("open");
      });
  });
})();
</script>

        </section>
<section id="features">
<h2>Features<a class="headerlink" href="#features" title="Link to this heading">#</a></h2>
<p>The CAS popup directive includes:</p>
<ul class="simple">
<li><p><strong>Resizable and draggable</strong> dialog window</p></li>
<li><p><strong>Scroll-locking</strong> when interacting with GeoGebra (prevents page scrolling)</p></li>
<li><p><strong>Theme-aware</strong> styling (adapts to light/dark mode)</p></li>
<li><p><strong>Touch support</strong> for mobile devices</p></li>
<li><p><strong>Customizable</strong> size, text, and layout</p></li>
<li><p><strong>Norwegian language</strong> support in GeoGebra interface</p></li>
</ul>
</section>
<section id="technical-details">
<h2>Technical Details<a class="headerlink" href="#technical-details" title="Link to this heading">#</a></h2>
<p>The directive:</p>
<ul class="simple">
<li><p>Uses jQuery UI for dialog functionality</p></li>
<li><p>Loads GeoGebra’s CAS perspective</p></li>
<li><p>Handles window resizing gracefully</p></li>
<li><p>Prevents background scrolling during interaction</p></li>
<li><p>Supports multiple instances on the same page</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./examples"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="interactive_code.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Interactive Code Examples</p>
      </div>
    </a>
    <a class="right-next"
       href="factor_tree.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Factor Tree Examples</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-usage">Basic Usage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-size">Custom Size</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-button-text-and-title">Custom Button Text and Title</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#norwegian-text">Norwegian Text</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sidebar-layout">Sidebar Layout</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-cas-windows">Multiple CAS Windows</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#features">Features</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#technical-details">Technical Details</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By René Ask
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>